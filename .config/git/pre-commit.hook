#!/bin/bash
# update .SRCINFO
for path in $(git diff --name-only --cached); do
	if [[ "${path}" =~ ^(.*/|)PKGBUILD$ && -f "${path}" ]]; then
		[[ -z "${path%PKGBUILD}" ]] && tmp='.' || tmp="${path%PKGBUILD}"
		printf "\033[1;32m%s\033[0m\033[1m%s\033[0m" "==>" " Generating and adding .SRCINFO for $tmp"
		pushd "$tmp" >/dev/null
		makepkg --printsrcinfo > .SRCINFO
		popd >/dev/null
		git add "$tmp"/.SRCINFO
	fi
done
